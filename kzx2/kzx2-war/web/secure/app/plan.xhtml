<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this template, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:rich="http://richfaces.org/rich">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
        <title>Plan</title>
    </head>
    <body>

        <ui:composition template="./../../resources/template/facesTemplate.xhtml">

            <ui:define name="content">
                <h:form id="frm">
                    <h:panelGroup rendered="#{planBean.agregar eq true or planBean.modificar eq true}">
                        <fieldset>
                            <h3><h:outputText value="#{loginBean.ubicacion}"/></h3>
                            <table class="tablaPlan">
                                <!--                                <tr>
                                                                    <th>Categoría</th>
                                                                    <td>Seleccione una categoría del plan.</td>
                                                                    <th><h:selectOneMenu id="categoria" value="#{planBean.plan.categoria.id}">
                                                                            <f:selectItems value="#{planBean.listaCategoria}"/>
                                                                            <rich:validator/>
                                                                        </h:selectOneMenu>&#160;<rich:messages for="frm:categoria"/>
                                                                    </th>
                                                                </tr>-->
                                <tr>
                                    <th>Nombre</th>
                                    <td>Póngale un nombre distintivo al plan.</td>
                                    <th><h:inputText id="nombre" value="#{planBean.plan.nombre}" size="25" maxlength="50"/> &#160;<rich:messages for="frm:nombre"/></th>
                                </tr>
                            </table>
                            <table class="tablaPlan">
                                <thead><h3>Entrega Inicial</h3></thead>
                                <tr>
                                    <th>Porcentaje de Entrega Mínima</th>
                                    <td>El porcentaje mínimo del precio de la moto que el comprador debe entregar.
                                        Este valor es opcional si decide fijarlo con un monto abajo.</td>
                                    <th><h:inputText id="porcentajeEntrega"  value="#{planBean.porcentajeEntregaMinima}" size="4" maxlength="3"/>&#160;%<rich:messages for="frm:porcentajeEntrega"/></th>
                                </tr>
                                <tr>
                                    <th>Monto Entrega Mínima</th>
                                    <td>El importe mínimo del precio de la moto que el comprador debe entregar.
                                        Este valor es opcional si decide fijarlo con un porcentaje arriba.</td>
                                    <th><h:inputText id="entregaMinima"  value="#{planBean.plan.montoEntregaMinimo}" size="10" maxlength="7">
                                            <f:ajax event="blur" render="@this"/>
                                            <f:convertNumber pattern="#{planBean.monedaPattern}"/>
                                            <rich:validator/>    
                                        </h:inputText>&#160;<rich:messages for="frm:entregaMinima"/></th>
                                </tr>
                                <tr>
                                    <th>Monto Entrega Máxima</th>
                                    <td>El importe máximo del precio de la moto que el comprador debe entregar.
                                        Este valor no debe acercarse mucho al precio total de la moto.</td>
                                    <th><h:inputText id="entregaMaxima"  value="#{planBean.plan.montoEntregaMaximo}" size="10" maxlength="7">
                                            <f:ajax event="blur" render="@this"/>
                                            <f:convertNumber pattern="#{planBean.monedaPattern}"/>
                                            <rich:validator/>    
                                        </h:inputText>&#160;<rich:messages for="frm:entregaMaxima"/></th>
                                </tr>
                            </table>
                            <table class="tablaPlan">
                                <thead><h3>Financiación</h3></thead>
                                <tr>
                                    <th>Cuota Mínima</th>
                                    <td>El número de cuotas mínimo con que una financiación puede comenzar.</td>
                                    <th><h:inputText id="financiacionMinima"  value="#{planBean.plan.financiacionMinima}" size="2" maxlength="2"/>&#160;<rich:messages for="frm:financiacionMinima"/></th>
                                </tr>
                                <tr>
                                    <th>Cuota Máxima</th>
                                    <td>El número de cuotas máximo con que una financiación puede comenzar.</td>
                                    <th><h:inputText id="financiacionMaxima"  value="#{planBean.plan.financiacionMaxima}" size="2" maxlength="2"/>&#160;<rich:messages for="frm:financiacionMaxima"/></th>
                                </tr>
                                <tr>
                                    <th>Cuotas Corridas Desde</th>
                                    <td>El número de cuotas mínimo que se puede utilizar para generar un plan de cuotas corridas.</td>
                                    <th><h:inputText id="cuotasCorridasDesde"  value="#{planBean.plan.cuotaCorridaDesde}" size="2" maxlength="2"/>&#160;<rich:messages for="frm:cuotasCorridasDesde"/></th>
                                </tr>
                                <tr>
                                    <th>Cuotas Corridas Hasta</th>
                                    <td>El número de cuotas máximo que se puede utilizar para generar un plan de cuotas corridas.</td>
                                    <th><h:inputText id="cuotasCorridasHasta"  value="#{planBean.plan.cuotaCorridaHasta}" size="2" maxlength="2"/>&#160;<rich:messages for="frm:cuotasCorridasHasta"/></th>
                                </tr>
                            </table>
                            <table class="tablaPlan">
                                <thead><h3>Interés</h3></thead>
                                <tr>
                                    <th>Tasa Anual</th>
                                    <td>Tasa de interés anual que se utilizará para la financiación. Valor fijado en porcentaje.</td>
                                    <th><h:inputText id="tasaAnual"  value="#{planBean.tasaAnual}" size="4" maxlength="4"/>&#160;%<rich:messages for="frm:tasaAnual"/></th>
                                </tr>
                                <tr>
                                    <th>Tasa Efectiva</th>
                                    <td>Tasa de interés efectiva que se utilizará para la financiación. Valor fijado en porcentaje.</td>
                                    <th><h:inputText id="tasaEfectiva"  value="#{planBean.tasaEfectiva}" size="4" maxlength="4"/>&#160;%<rich:messages for="frm:tasaEfectiva"/></th>
                                </tr>
                                <tr>
                                    <th>Tasa Moratoria</th>
                                    <td>Tasa de interés moratoria que se utilizará para el cálculo de cuotas vencidas. Valor fijado en porcentaje.</td>
                                    <th><h:inputText id="moratorio"  value="#{planBean.tasaMoratoria}" size="4" maxlength="4"/>&#160;%<rich:messages for="frm:moratorio"/></th>
                                </tr>
                                <tr>
                                    <th>Tasa Punitoria</th>
                                    <td>Tasa de interés para el cálculo del monto cuando la deuda pasa a un proceso judicial. Valor fijado en porcentaje.</td>
                                    <th><h:inputText id="punitorio"  value="#{planBean.tasaPunitoria}" size="4" maxlength="4"/>&#160;%<rich:messages for="frm:punitorio"/></th>
                                </tr>
                                <tr>
                                    <th>Indice de Redondeo</th>
                                    <td>El índice para redondear valores. Recuerde poner un número negativo para acercar a valores mas redondeados</td>
                                    <th><h:inputText id="redondeo"  value="#{planBean.plan.indiceRedondeo}" size="4" maxlength="3"/>&#160;<rich:messages for="frm:redondeo"/></th>
                                </tr>
                                <tr>
                                    <th>Días a primer vencimiento</th>
                                    <td>La cantidad de días después de la venta donde se generará la primera cuota.</td>
                                    <th><h:inputText id="dias"  value="#{planBean.plan.diasAPrimerVencimiento}" size="2" maxlength="2"/>&#160;<rich:messages for="frm:dias"/></th>
                                </tr>
                                <tr>
                                    <th>Rango de Negociación</th>
                                    <td>Monto que el vendedor tiene habilitado para negociar un último precio cuando la venta es al contado.</td>
                                    <th><h:inputText id="rangoNegociacionMaximo"  value="#{planBean.plan.rangoNegociacionMaximo}" size="11" maxlength="7"/>&#160;<rich:messages for="frm:rangoNegociacionMaximo"/></th>
                                </tr>
                                <tr>
                                    <th>Porcentaje de Descuento</th>
                                    <td>Porcentaje del total de la venta como descuento concedido. Este valor se omite si define un descuento en importe. Valor fijado en porcentaje.</td>
                                    <th><h:inputText id="porcentajeDescuento"  value="#{planBean.plan.porcentajeDescuento}" size="4" maxlength="3"/>&#160;%<rich:messages for="frm:porcentajeDescuento"/></th>
                                </tr>
                                <tr>
                                    <th>Monto del Descuento</th>
                                    <td>Importe del descuento concedido. Este valor se omite si define un porcentaje de descuento.</td>
                                    <th><h:inputText id="montoDescuento"  value="#{planBean.plan.montoDescuento}" size="11" maxlength="7">
                                            <f:ajax event="blur" render="@this"/>
                                            <f:convertNumber pattern="#{planBean.monedaPattern}"/>
                                            <rich:validator/>    
                                        </h:inputText>&#160;<rich:messages for="frm:porcentajeDescuento"/></th>
                                </tr>
                            </table>

                            <div class="botonera">
                                <input class="submit" type="submit" jsfc="h:commandButton" value="Guardar" action="#{planBean.guardar}"/>
                                <h:commandButton value="Cancelar" action="#{planBean.todos}" immediate="true"/>
                            </div>
                        </fieldset>
                    </h:panelGroup>
                    <h:panelGroup rendered="#{planBean.agregar eq false and planBean.modificar eq false}">
                        <fieldset>
                            <h3><h:outputText value="#{loginBean.ubicacion}"/></h3>
                            <table class="busqueda">
                                <tr>
                                    <td>
                                        <label for="idFiltro">Nº:</label>
                                        <h:inputText id="idFiltro"  value="#{planBean.idFiltro}" size="5" maxlength="14"/>
                                    </td>
                                    <td>
                                        <label for="categoriaFiltro">Categoria: </label>
                                        <h:selectOneMenu id="categoriaFiltro" value="#{planBean.categoriaFiltro}">
                                            <f:selectItems value="#{planBean.listaCategoria}"/>
                                        </h:selectOneMenu>
                                    </td>
                                    <td>
                                        <label for="nombreFiltro">Nombre: </label>
                                        <h:inputText id="nombreFiltro" value="#{planBean.nombreFiltro}" size="50" maxlength="50"/>
                                    </td>
                                    <td>
                                        <label for="activoFiltro">Activo: </label>
                                        <h:selectOneMenu id="activoFiltro" value="#{planBean.activoFiltro}">
                                            <f:selectItem itemValue="X" itemLabel="-SELECCIONAR-"/>
                                            <f:selectItem itemValue="S" itemLabel="SI"/>
                                            <f:selectItem itemValue="N" itemLabel="NO"/>
                                        </h:selectOneMenu>
                                    </td>
                                </tr>
                            </table>
                            <div class="botonera">
                                <input id="btnBuscar" class="submit" type="submit" jsfc="h:commandButton" value="Buscar" action="#{planBean.buscar}"/>
                                <input class="submit" type="submit" jsfc="h:commandButton" value="Todos" action="#{planBean.todos}"/>
                            </div>
                        </fieldset>
                        <div class="mensajes">
                            <h:messages id="messages" errorClass="messageError" infoClass="messageInfo" warnClass="messageWarn"/>
                        </div>
                        <fieldset>
                            <h:panelGroup rendered="#{not empty planBean.lista }">
                                <table class="tablaDatos">
                                    <thead>
                                        <tr>
                                            <th width="2%"></th>
                                            <th width="5%"><p>
                                                    <h:commandLink action="#{planBean.listar}">Nº
                                                        <f:setPropertyActionListener value="id" target="#{planBean.facade.orden.columna}"/>
                                                        <f:setPropertyActionListener value="true" target="#{planBean.facade.orden.asc}"/>
                                                    </h:commandLink>
                                                    <h:outputText value="#{(planBean.facade.orden.asc) ? '▲' : '▼'}"
                                                                  rendered="#{planBean.facade.orden.columna eq 'id'}"/></p></th>
                                            <th><p>
                                                    <h:commandLink action="#{planBean.listar}">Nombre
                                                        <f:setPropertyActionListener value="nombre" target="#{planBean.facade.orden.columna}"/>
                                                        <f:setPropertyActionListener value="true" target="#{planBean.facade.orden.asc}"/>
                                                    </h:commandLink>
                                                    <h:outputText value="#{(planBean.facade.orden.asc) ? '▲' : '▼'}"
                                                                  rendered="#{planBean.facade.orden.columna eq 'nombre'}"/></p></th>
                                            <th><p>
                                                    <h:commandLink action="#{planBean.listar}">Categoría
                                                        <f:setPropertyActionListener value="categoria" target="#{planBean.facade.orden.columna}"/>
                                                        <f:setPropertyActionListener value="true" target="#{planBean.facade.orden.asc}"/>
                                                    </h:commandLink>
                                                    <h:outputText value="#{(planBean.facade.orden.asc) ? '▲' : '▼'}"
                                                                  rendered="#{planBean.facade.orden.columna eq 'categoria'}"/></p></th>
                                            <th><p>
                                                    <h:commandLink action="#{planBean.listar}">Activo
                                                        <f:setPropertyActionListener value="activo" target="#{planBean.facade.orden.columna}"/>
                                                        <f:setPropertyActionListener value="true" target="#{planBean.facade.orden.asc}"/>
                                                    </h:commandLink>
                                                    <h:outputText value="#{(planBean.facade.orden.asc) ? '▲' : '▼'}"
                                                                  rendered="#{planBean.facade.orden.columna eq 'activo'}"/></p></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <ui:repeat var="row" value="#{planBean.lista}">
                                            <tr>
                                                <td><input type="radio" id="radio" name="radio"
                                                           value="#{row.id}"/></td>
                                                <td><h:outputText value="#{row.id}"/></td>
                                                <td><h:outputText value="#{row.nombre}"/></td>
                                                <td><h:outputText value="#{row.categoria.descripcion}"/></td>
                                                <td>
                                                    <h:panelGroup rendered="#{row.activo eq 'S'}"><img src="../../resources/images/onebit_06.png" width="15"/></h:panelGroup>
                                                    <h:panelGroup rendered="#{row.activo eq 'N'}"><img src="../../resources/images/onebit_10.png" width="15"/></h:panelGroup>
                                                </td>
                                            </tr>
                                        </ui:repeat>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="9">
                                                <h:commandLink action="#{planBean.anterior}">Anterior</h:commandLink>
                                                &#160;|&#160;#{planBean.desde + 1}..#{planBean.facade.ultimo} de #{planBean.facade.contador}&#160;|&#160;
                                                <h:commandLink action="#{planBean.siguiente}">Siguiente</h:commandLink>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </h:panelGroup>
                            <div class="botonera">
                                <h:commandButton id="btnNuevo" value="Nuevo" action="#{planBean.nuevo}" styleClass="submit"/>
                                <h:commandButton id="btnModificar" value="Modificar" action="#{planBean.modificar}" styleClass="submit" rendered="#{not empty planBean.lista }"/>
                            </div>
                        </fieldset>
                    </h:panelGroup>
                </h:form>
            </ui:define>
        </ui:composition>
    </body>
</html>